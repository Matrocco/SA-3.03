Building configuration...

  [OK][OK]
R#
*Jan 29 13:09:44.941: %SYS-2-PRIVCFG_ENCRYPT: Successfully encrypted private config fileping 172.16.1.2
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 172.16.1.2, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 4/4/6 ms
R#ping 172.16.1.1
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 172.16.1.1, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 1/1/1 ms
R#end
Translating "end"

% Bad IP address or host name
Translating "end"

% Unknown command or computer name, or unable to find computer address
R# 
*Jan 29 13:10:01.581: %OSPF-4-DUP_RTRID_NBR: OSPF detected duplicate router-id 192.168.60.254 from 10.4.2.1 on interface Giga4
*Jan 29 13:11:07.557: %OSPF-4-DUP_RTRID_NBR: OSPF detected duplicate router-id 192.168.60.254 from 10.4.2.1 on interface Giga4
*Jan 29 13:12:13.783: %OSPF-4-DUP_RTRID_NBR: OSPF detected duplicate router-id 192.168.60.254 from 10.4.2.1 on interface Giga4
*Jan 29 13:13:14.967: %OSPF-4-DUP_RTRID_NBR: OSPF detected duplicate router-id 192.168.60.254 from 10.4.2.1 on interface Giga4
R#
R#
R#conf t
Enter configuration commands, one per line.  End with CNTL/Z.
R(config)#int
R(config)#interface tun
R(config)#interface tunnel 1
R(config-if)# ip access-group 1 in
R(config-if)# ip nat inside
R(config-if)# ip virtual-reassembly in
R(config-if)#end                      
R#wr
Building configuration...

  [OK][OK]
R#
*Jan 29 13:14:11.199: %SYS-5-CONFIG_I: Configured from console by console
*Jan 29 13:14:13.997: %SYS-2-PRIVCFG_ENCRYPT: Successfully encrypted private config file
R#
R#
R#sh run
Building configuration...

  
Current configuration : 5022 bytes
!
! Last configuration change at 13:14:11 UTC Thu Jan 29 2026
!
version 15.8
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname R
!
boot-start-marker
boot-end-marker
!
!
enable secret 5 $1$Fo0u$85h/47H8VFhkphiyKlLan0
!
no aaa new-model
!
!
!
!
!         
!
!
!
ip dhcp excluded-address 192.168.10.1 192.168.10.99
ip dhcp excluded-address 192.168.10.151 192.168.10.254
ip dhcp excluded-address 192.168.20.1 192.168.20.99
ip dhcp excluded-address 192.168.20.151 192.168.20.254
ip dhcp excluded-address 192.168.30.1 192.168.30.99
ip dhcp excluded-address 192.168.30.151 192.168.30.254
ip dhcp excluded-address 192.168.40.1 192.168.40.99
ip dhcp excluded-address 192.168.40.151 192.168.40.254
ip dhcp excluded-address 192.168.50.1 192.168.50.99
ip dhcp excluded-address 192.168.50.151 192.168.50.254
ip dhcp excluded-address 192.168.60.1 192.168.60.99
ip dhcp excluded-address 192.168.60.151 192.168.60.254
!
ip dhcp pool VLAN_10
 network 192.168.10.0 255.255.255.0
 default-router 192.168.10.254 
 dns-server 172.18.26.101 
!
ip dhcp pool VLAN_20
 --More-- 
*Jan 29 13:14:17.215: %OSPF-4-DUP_RTRID_NBR: OSPF detected duplicate router-id 192.168.60.254 from 10.4.2.1 on inte network 10
 default-router 192.168.20.254 
 dns-server 172.18.26.101 
!
ip dhcp pool VLAN_30
 network 192.168.30.0 255.255.255.0
 default-router 192.168.30.254 
 dns-server 172.18.26.101 
!
ip dhcp pool vlan 40
 network 192.168.40.0 255.255.255.0
 default-router 192.168.40.254 
 dns-server 172.18.26.101 
!
ip dhcp pool vlan 60
 network 192.168.60.0 255.255.255.0
 default-router 192.168.60.254 
 dns-server 172.18.26.101 
!
ip dhcp pool vlan 50
 network 192.168.50.0 255.255.255.0
 default-router 192.168.50.254 
 dns-server 172.18.26.101 
!         
!
!
no ip domain lookup
ip domain name entreprise10.local
ip cef
no ipv6 cef
!
multilink bundle-name authenticated
!
!
!
license udi pid C927-4P sn FGL2348L2DU
license boot module c900 technology-package securityk9
!
!
vtp version 2
username groupe10 secret 5 $1$jc/y$NdqeeTFlBD5R40BWhhpft1
!
redundancy
!
!
!
!         
!
controller VDSL 0
!
! 
!
crypto isakmp policy 10
 encr aes
 hash sha256
 authentication pre-share
 group 14
crypto isakmp key progtr00 address 10.4.2.1       
!
!
crypto ipsec transform-set myset esp-aes esp-sha256-hmac 
 mode tunnel
!
crypto ipsec profile IPSEC_PROFILE
 set transform-set myset 
!
!
!
!
!         
!
!
interface Tunnel1
 ip address 172.16.1.1 255.255.255.252
 ip access-group 1 in
 ip nat inside
 ip virtual-reassembly in
 tunnel source 10.4.1.1
 tunnel mode ipsec ipv4
 tunnel destination 10.4.2.1
 tunnel protection ipsec profile IPSEC_PROFILE
!
interface ATM0
 no ip address
 shutdown
 no atm ilmi-keepalive
!
interface Ethernet0
 no ip address
 shutdown
!
interface GigabitEthernet0
 switchport mode trunk
 no ip address
!
interface GigabitEthernet1
 no ip address
!
interface GigabitEthernet2
 no ip address
!
interface GigabitEthernet3
 no ip address
!
interface GigabitEthernet4
 ip address 10.4.1.1 255.0.0.0
 ip access-group 1 in
 ip nat outside
 ip virtual-reassembly in
 duplex auto
 speed auto
!
interface Vlan1
 no ip address
!
interface Vlan10
 ip address 192.168.10.254 255.255.255.0
 ip access-group 1 in
 ip nat inside
 ip virtual-reassembly in
!
interface Vlan20
 ip address 192.168.20.254 255.255.255.0
 ip access-group 1 in
 ip nat inside
 ip virtual-reassembly in
!
interface Vlan30
 ip address 192.168.30.254 255.255.255.0
 ip access-group 1 in
 ip nat inside
 ip virtual-reassembly in
!
interface Vlan40
 ip address 192.168.40.254 255.255.255.0
 ip access-group 1 in
 ip nat inside
 ip virtual-reassembly in
!         
interface Vlan50
 ip address 192.168.50.254 255.255.255.0
 ip access-group 1 in
 ip nat inside
 ip virtual-reassembly in
!
interface Vlan60
 ip address 192.168.60.254 255.255.255.0
 ip access-group 1 in
 ip nat inside
 ip virtual-reassembly in
!
router ospf 1
 network 10.0.0.0 0.255.255.255 area 1
 network 172.16.1.0 0.0.0.3 area 1
 network 192.168.10.0 0.0.0.255 area 1
 network 192.168.20.0 0.0.0.255 area 1
 network 192.168.30.0 0.0.0.255 area 1
 network 192.168.40.0 0.0.0.255 area 1
 network 192.168.50.0 0.0.0.255 area 1
 network 192.168.60.0 0.0.0.255 area 1
!
ip forward-protocol nd
no ip http server
no ip http secure-server
!
!
ip nat inside source list 1 interface GigabitEthernet4 overload
ip route 0.0.0.0 0.0.0.0 10.0.0.1
!
!
!
tftp-server flash:/firmware/vadsl_module_img.bin
access-list 1 permit 192.168.10.0 0.0.0.255
access-list 1 permit any
access-list 1 permit 192.168.20.0 0.0.0.255
access-list 1 permit 192.168.30.0 0.0.0.255
access-list 1 permit 192.168.40.0 0.0.0.255
access-list 1 permit 192.168.50.0 0.0.0.255
access-list 1 permit 192.168.60.0 0.0.0.255
access-list 1 permit 172.16.1.0 0.0.0.2
!
control-plane
!
!
line con 0
line 4
 no activation-character
 transport preferred none
 transport input all
 transport output all
 stopbits 1
line vty 0 3
 access-class 10 in
 exec-timeout 5 0
 login local
 transport input ssh
line vty 4
 access-class 10 in
 exec-timeout 5 0
 login local
 transport input ssh
 transport output ssh
!
scheduler allocate 20000 1000
!
end

